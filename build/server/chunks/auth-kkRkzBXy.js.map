{"version":3,"file":"auth-kkRkzBXy.js","sources":["../../../.svelte-kit/adapter-node/chunks/auth.js"],"sourcesContent":["import { d as derived, w as writable } from \"./index2.js\";\nimport { a as auth } from \"./firebase.js\";\nconst user = writable(null);\nconst isAuthenticated = derived(user, ($user) => !!$user);\nasync function refreshToken() {\n  try {\n    const currentUser = auth.currentUser;\n    if (currentUser) {\n      const token = await currentUser.getIdToken(true);\n      await fetch(\"/api/auth/refresh-token\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({ token })\n      });\n    }\n  } catch (error) {\n    console.error(\"Token refresh error:\", error);\n    throw error;\n  }\n}\nauth.onAuthStateChanged(async (newUser) => {\n  user.set(newUser);\n  if (newUser) {\n    await refreshToken();\n  }\n});\nexport {\n  isAuthenticated as i,\n  user as u\n};\n"],"names":[],"mappings":";;;AAEK,MAAC,IAAI,GAAG,QAAQ,CAAC,IAAI;AACrB,MAAC,eAAe,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC,KAAK,KAAK,CAAC,CAAC,KAAK;AACxD,eAAe,YAAY,GAAG;AAC9B,EAAE,IAAI;AACN,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW;AACxC,IAAI,IAAI,WAAW,EAAE;AACrB,MAAM,MAAM,KAAK,GAAG,MAAM,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC;AACtD,MAAM,MAAM,KAAK,CAAC,yBAAyB,EAAE;AAC7C,QAAQ,MAAM,EAAE,MAAM;AACtB,QAAQ,OAAO,EAAE;AACjB,UAAU,cAAc,EAAE;AAC1B,SAAS;AACT,QAAQ,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE;AACtC,OAAO,CAAC;AACR;AACA,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,KAAK,CAAC;AAChD,IAAI,MAAM,KAAK;AACf;AACA;AACA,IAAI,CAAC,kBAAkB,CAAC,OAAO,OAAO,KAAK;AAC3C,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC;AACnB,EAAE,IAAI,OAAO,EAAE;AACf,IAAI,MAAM,YAAY,EAAE;AACxB;AACA,CAAC,CAAC;;;;"}