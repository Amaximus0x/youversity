<script lang="ts">
    import { createEventDispatcher } from 'svelte';
    import { fade, fly } from 'svelte/transition';
    import TagsSidebar from './TagsSidebar.svelte';
    
    export let isOpen = false;
    export let availableTags: { id: string; name: string; count: number }[] = [];
    export let tagVideos: { [key: string]: any[] } = {};
    
    const dispatch = createEventDispatcher();
    
    function closeSidebar() {
        dispatch('close');
    }
    
    function handleTagClick(tagId: string) {
        // Handle tag selection logic here
        console.log('Tag clicked:', tagId);
    }
</script>

{#if isOpen}
    <!-- Backdrop -->
    <div 
        class="fixed inset-0 bg-black/50 z-40 lg:hidden"
        on:click={closeSidebar}
        transition:fade={{ duration: 300 }}
    />
    
    <!-- Sidebar -->
    <div 
        class="fixed left-0 top-0 w-[240px] h-full z-50 lg:hidden bg-gradient-light dark:bg-gradient-dark border border-light-border dark:border-dark-border shadow-lg"
        transition:fly={{ x: -280, duration: 300 }}
    >
        <div class="flex flex-col h-full pt-6 px-4 pb-4 gap-4">
            <!-- Header -->
            <!-- Logo -->
            <a href="/" class="flex items-center gap-[5.43px]">
                <img src="/YV.svg" alt="Youversity Logo" class="w-[35.29px] h-[38px] flex-shrink-0" />
                <svg xmlns="http://www.w3.org/2000/svg" class= "w-[86px] h-18px] pt-[13.6px] pb-[7.67px] text-light-text-primary dark:text-dark-text-primary" viewBox="0 0 86 18" fill="none">
                    <path d="M10.0821 1.79174L6.33634 9.00631V13.1103H4.47977V9.00631L0.717773 1.79174H2.78606L5.40806 7.34517L8.03005 1.79174H10.0821Z" fill="currentColor"/>
                    <path d="M15.4477 13.2569C14.6008 13.2569 13.8354 13.0669 13.1514 12.6869C12.4674 12.296 11.93 11.7532 11.5391 11.0583C11.1483 10.3526 10.9528 9.53831 10.9528 8.61546C10.9528 7.70346 11.1537 6.8946 11.5554 6.18888C11.9571 5.48317 12.5054 4.94031 13.2003 4.56031C13.8951 4.18031 14.6714 3.99031 15.5291 3.99031C16.3868 3.99031 17.1631 4.18031 17.858 4.56031C18.5528 4.94031 19.1011 5.48317 19.5028 6.18888C19.9045 6.8946 20.1054 7.70346 20.1054 8.61546C20.1054 9.52746 19.8991 10.3363 19.4865 11.042C19.074 11.7477 18.5094 12.296 17.7928 12.6869C17.0871 13.0669 16.3054 13.2569 15.4477 13.2569ZM15.4477 11.6446C15.9254 11.6446 16.3705 11.5306 16.7831 11.3026C17.2065 11.0746 17.5485 10.7326 17.8091 10.2766C18.0697 9.8206 18.2 9.26688 18.2 8.61546C18.2 7.96403 18.0751 7.41574 17.8254 6.9706C17.5757 6.5146 17.2445 6.1726 16.832 5.9446C16.4194 5.7166 15.9743 5.6026 15.4965 5.6026C15.0188 5.6026 14.5737 5.7166 14.1611 5.9446C13.7594 6.1726 13.4391 6.5146 13.2003 6.9706C12.9614 7.41574 12.842 7.96403 12.842 8.61546C12.842 9.58174 13.0863 10.3309 13.5748 10.8629C14.0743 11.384 14.6985 11.6446 15.4477 11.6446Z" fill="currentColor"/>
                    <path d="M30.0673 4.13688V13.1103H28.2107V12.0517C27.9176 12.4209 27.5321 12.714 27.0544 12.9312C26.5876 13.1375 26.0881 13.2406 25.5561 13.2406C24.8504 13.2406 24.2153 13.094 23.6507 12.8009C23.097 12.5077 22.6573 12.0735 22.3316 11.498C22.0167 10.9226 21.8593 10.2277 21.8593 9.41346V4.13688H23.6996V9.1366C23.6996 9.94003 23.9004 10.5589 24.3021 10.9932C24.7039 11.4166 25.2521 11.6283 25.947 11.6283C26.6419 11.6283 27.1901 11.4166 27.5919 10.9932C28.0044 10.5589 28.2107 9.94003 28.2107 9.1366V4.13688H30.0673Z" fill="currentColor"/>
                    <path d="M35.9857 11.4492L38.5263 4.13688H40.4969L37.0769 13.1103H34.862L31.4583 4.13688H33.4452L35.9857 11.4492Z" fill="currentColor"/>
                    <path d="M50.1245 8.40374C50.1245 8.74031 50.1028 9.04431 50.0594 9.31574H43.2031C43.2574 10.0323 43.5234 10.6077 44.0011 11.042C44.4788 11.4763 45.0651 11.6935 45.7599 11.6935C46.7588 11.6935 47.4645 11.2755 47.8771 10.4395H49.8802C49.6088 11.2646 49.1148 11.9432 48.3982 12.4752C47.6925 12.9963 46.8131 13.2569 45.7599 13.2569C44.9022 13.2569 44.1314 13.0669 43.4474 12.6869C42.7742 12.296 42.2422 11.7532 41.8514 11.0583C41.4714 10.3526 41.2814 9.53831 41.2814 8.61546C41.2814 7.6926 41.466 6.88374 41.8351 6.18888C42.2151 5.48317 42.7417 4.94031 43.4148 4.56031C44.0988 4.18031 44.8805 3.99031 45.7599 3.99031C46.6068 3.99031 47.3614 4.17488 48.0237 4.54403C48.686 4.91317 49.2017 5.43431 49.5708 6.10746C49.9399 6.76974 50.1245 7.53517 50.1245 8.40374ZM48.1865 7.81746C48.1757 7.13346 47.9314 6.58517 47.4537 6.1726C46.9759 5.76003 46.3842 5.55374 45.6785 5.55374C45.038 5.55374 44.4897 5.76003 44.0337 6.1726C43.5777 6.57431 43.3062 7.1226 43.2194 7.81746H48.1865Z" fill="currentColor"/>
                    <path d="M53.8081 5.43974C54.0796 4.98374 54.4379 4.63088 54.883 4.38117C55.339 4.1206 55.8764 3.99031 56.4953 3.99031V5.91203H56.023C55.2956 5.91203 54.7419 6.0966 54.3619 6.46574C53.9927 6.83488 53.8081 7.47546 53.8081 8.38746V13.1103H51.9516V4.13688H53.8081V5.43974Z" fill="currentColor"/>
                    <path d="M61.459 13.2569C60.7533 13.2569 60.1181 13.132 59.5536 12.8823C58.9998 12.6217 58.5601 12.2743 58.2344 11.84C57.9087 11.3949 57.735 10.9009 57.7133 10.358H59.635C59.6676 10.738 59.8467 11.0583 60.1724 11.3189C60.509 11.5686 60.927 11.6935 61.4264 11.6935C61.9476 11.6935 62.3493 11.5957 62.6316 11.4003C62.9247 11.194 63.0713 10.9335 63.0713 10.6186C63.0713 10.282 62.9084 10.0323 62.5827 9.86946C62.2678 9.7066 61.763 9.52746 61.0681 9.33203C60.395 9.14746 59.8467 8.96831 59.4233 8.7946C58.9998 8.62088 58.6307 8.35488 58.3158 7.9966C58.0118 7.63831 57.8598 7.16603 57.8598 6.57974C57.8598 6.10203 58.001 5.66774 58.2833 5.27688C58.5656 4.87517 58.9673 4.56031 59.4884 4.33231C60.0204 4.10431 60.6284 3.99031 61.3124 3.99031C62.333 3.99031 63.1527 4.25088 63.7716 4.77203C64.4013 5.28231 64.7378 5.9826 64.7813 6.87288H62.9247C62.8921 6.47117 62.7293 6.15088 62.4361 5.91203C62.143 5.67317 61.7467 5.55374 61.2473 5.55374C60.7587 5.55374 60.3841 5.64603 60.1236 5.8306C59.863 6.01517 59.7327 6.25946 59.7327 6.56346C59.7327 6.80231 59.8196 7.00317 59.9933 7.16603C60.167 7.32888 60.3787 7.45917 60.6284 7.55688C60.8781 7.64374 61.2473 7.75774 61.7358 7.89888C62.3873 8.0726 62.9193 8.25174 63.3318 8.43631C63.7553 8.61003 64.119 8.8706 64.423 9.21803C64.727 9.56546 64.8844 10.0269 64.8953 10.6023C64.8953 11.1126 64.7541 11.5686 64.4718 11.9703C64.1896 12.372 63.7878 12.6869 63.2667 12.9149C62.7564 13.1429 62.1538 13.2569 61.459 13.2569Z" fill="currentColor"/>
                    <path d="M67.8459 2.94803C67.5093 2.94803 67.2271 2.83403 66.999 2.60603C66.771 2.37803 66.6571 2.09574 66.6571 1.75917C66.6571 1.4226 66.771 1.14031 66.999 0.912313C67.2271 0.684313 67.5093 0.570312 67.8459 0.570312C68.1716 0.570312 68.4485 0.684313 68.6765 0.912313C68.9045 1.14031 69.0185 1.4226 69.0185 1.75917C69.0185 2.09574 68.9045 2.37803 68.6765 2.60603C68.4485 2.83403 68.1716 2.94803 67.8459 2.94803ZM68.7579 4.13688V13.1103H66.9013V4.13688H68.7579Z" fill="currentColor"/>
                    <path d="M73.3614 5.65145V10.6186C73.3614 10.9552 73.4374 11.1995 73.5894 11.3515C73.7523 11.4926 74.0237 11.5632 74.4037 11.5632H75.5437V13.1103H74.078C73.242 13.1103 72.6014 12.9149 72.1563 12.524C71.7111 12.1332 71.4886 11.498 71.4886 10.6186V5.65145H70.43V4.13688H71.4886V1.90574H73.3614V4.13688H75.5437V5.65145H73.3614Z" fill="currentColor"/>
                    <path d="M85.3326 4.13688L79.828 17.3283H77.9063L79.7303 12.9637L76.1963 4.13688H78.2646L80.7888 10.9769L83.4108 4.13688H85.3326Z" fill="currentColor"/>
                  </svg>
            </a>
            
            <!-- TagsSidebar component -->
            <TagsSidebar
                availableTags={availableTags}
                tagVideos={tagVideos}
            ></TagsSidebar>

        </div>
    </div>
{/if}